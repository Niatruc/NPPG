本文介绍尽量少的够用的Ruby知识，避免触及Ruby复杂的反射和内省机制，以便用户开发自己的子功能模块。
- [前言](#前言)
- [Ruby世界的一些重要思想](#Ruby世界的一些重要思想)
  - [一切皆对象](#一切皆对象)
- [常用数据类型](#常用数据类型)
- [控制流程](#控制流程)
  - [顺序](#顺序)
  - [选择](#选择)
  - [循环](#循环)

# 前言
Ruby常用打印方法：`p`、`puts`和`print`方法，其中`p`在调试时最常用。
形如`Integer#times`表示`Integer`类的实例方法`times`。

# Ruby世界的一些重要思想
## 一切皆对象
在Ruby中，无论是数字、字符串，还是数组、散列、正则表达式，抑或是类、模块。Ruby的点运算符永远表示一个对象调用它的一个方法，**这是Ruby和Python、JavaScript最大的不同点之一。在后两者中，`me.age`可能表示`me`这个实例的age属性，但是在Ruby中并没有这种用法，`age`只能称为me的方法，它的实例变量以`@age`的形式出现在me所属类的定义内部，然后由它的getter也即`me.age`方法获取。换种角度，在Python和Javascript中，当实例`me`有一个方法`get_age`时，执行代码`me.get_age`将返回一个函数类型值（py和js将函数作为一等公民），在该值后加上括号`me.get_age()`则是调用该函数并返回值；而在Ruby中，执行代码`me.get_age`将使`me`立即调用方法`get_age`并返回结果。**这也意味着在Ruby中，方法后面的括号可以省略，因此看起来更像脚本命令。
下面给出一些Ruby对象调用方法的示例，直观了解Ruby的样子。

|代码|解释|
|:-|:-|
|`10.times {\|i\| p i}`|整数`10`调用`times`方法，参数是后面的代码块|
|`1+2`|整数`1`调用`+`方法,参数是整数`2`|
|`1.1.to_s`|浮点数`1.1`调用`to_s`方法|
|`"hello".sub /h/`|字符串`"hello"`调用`sub`方法，参数是后面的正则表达式`/h/`|
|`[].empty?`|数组`[]`调用`empty?`方法|
|`{a:1}.keys`|散列`{a:1}`调用`keys`方法|
|`/hello/ =~ "hello"`|正则表达式`/hello/`调用`=~`方法，参数是字符串`"hello"`|
|`me.age = 20`|`me`调用`age=`方法，参数是整数`20`|

## 代码皆有返回值
任何代码执行后都有返回值。代码块获方法通常以最后一行代码产生的值作为返回值（此时可以不写`return`）
```ruby
# 得到a的值为true
i = 10
a = i > 0

# 得到b的值为2
b = if false; 1 else 2 end

def add(a, b)
  # 将a+b作为返回值
  a + b
end
```

# 常用数据类型
|类型|解释|示例|
|:-|:------:|:-|
|数字相关|整数、浮点数、范围值|`1`，`1.1`，`1..10`|
|字符串相关|字符串，符号（可理解为不可变的字符串），正则表达式|`"he"`，`:he`，`/he/`|
|数组|可存任意类型值|`[1, 'a', :b, [2, 3]]`|
|散列|相当于python中的字典|`h = {a: 1, "b" => 2}`，则`h[:a]`值为`1`，`h["b"]`值为`2`|
|块类型|相当于python中的函数类型，是一个由代码组成的块|`10.times {\|i\| p i}` 中花括号部分即为块类型，它作为参数传给times方法。块中的`i`又是该块的参数。另一种写法是`10.times do \|i\| p i end`。你可以了解一下js的匿名函数，跟这个异曲同工。|
|布尔值和空值|true，false，nil||

# 控制流程
## 顺序
就是代码从上往下执行啦，所有编程语言通性。

## 选择
```ruby
i = 10

# 三元表达式
a = (i == 10 ? 1 : 9)

# if表达式
if i
  print "it's true"
end

# case表达式
case i
when 1
  p 'a'
when 2, 3
  p 'b'
else
  p 'c'

```
注意，除了false和nil值判断为假，其它值皆判断为真。

### 循环
```ruby
i = 10

# while表达式
while i > 0
  p i
  i -= 1
end

# 有个for表达式，但比较少用。

# 使用Integer#times方法
i.times do |j|
  p j
end

# 可枚举对象使用each方法：
(1..i).each do |j|
  p j
end
```
